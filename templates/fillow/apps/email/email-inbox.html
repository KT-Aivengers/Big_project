{% extends 'fillow/elements/layouts/admin.html' %}
{% load static %}

{% block additional_css %}
<style>
	.category {
		color: #fff !important;
	}

	.rounded-cat {
		border-radius: 50%;
		color: #fff;
		width: 45px;
		height: 45px;
		font-size: 11px;
	}

	.read {
		opacity: 30%;
	}

	#cat1, .결재승인 {
		background-color: #fc2e53;
	}

	#cat2, .휴가{
		background-color: #ffbf00;
	}

	#cat3, .진행업무 {
		background-color: #09bd3c;
	}

	#cat4, .회의 {
		background-color: #128a7e;
	}

	#cat5, .보고{
		background-color: #369fc2;
	}

	#cat6, .스크랩 {
		background-color: #ffa7d7;
	}

	#cat7, .공지 {
		background-color: #6238fc;
	}

	#cat8, .감사인사 {
		background-color: #d653c1;
	}

	#cat9, .기타 {
		background-color: #c8c8c8;
	}
</style>
{% endblock %}
{% block content %}

<div class="content-body default-height">

  <div class="container-fluid">
	<div class="row page-titles">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a href="javascript:void(0)">이메일</a></li>
			<li class="breadcrumb-item active"><a href="javascript:void(0)">받은 이메일</a></li>
		</ol>
	</div>
	<div class="row">
		<div class="col-lg-12">
			<div class="card">
				<div class="card-body">
					<div class="row">
						<div class="col-xl-3">
							<div class="email-left-body email-left-box ">
								<div class="mb-3 mt-4 mt-sm-0">
									<div class="p-0 row">
										<div class="col-lg-6">
											<a href="{% url 'fillow:email-compose' %}" class="btn btn-primary btn-block col-lg-6">이메일 쓰기</a>
										</div>
										<div class="col-lg-6">
											<a href="{% url 'fillow:email-sent' %}" class="btn btn-primary btn-block">보낸 이메일</a>
										</div>
									</div>
									<div class="mail-list rounded mt-4">
										{% if unread_email_count > 0 %}
											<a href="{% url 'fillow:email_list' %}" class="list-group-item" id="inbox">
												<i class="fa fa-inbox font-18 align-middle me-2"></i>받은 이메일<span
												class="badge badge-danger text-white badge-sm float-end">{{ unread_email_count }}</span>
											</a>
										{% else %}
											<a href="{% url 'fillow:email_list' %}" class="list-group-item" id="inbox">
												<i class="fa fa-inbox font-18 align-middle me-2"></i>받은 이메일
											</a>
										{% endif %}
												
										<a href="{% url 'fillow:email-list-trash' %}" class="list-group-item"><i
												class="fa fa-trash font-18 align-middle me-2"></i>휴지통</a>
									</div>
									<div class="mail-list rounded overflow-hidden">
										<div class="intro-title d-flex justify-content-between mt-0">
											<h5>카테고리</h5>
										</div>
										<div class="row">
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=결재승인" id="cat1" class="list-group-item category"><span class="icon-warning"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												결재승인 </a>
											</div>
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=휴가" id="cat2" class="list-group-item category"><span class="icon-primary"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												휴가 </a>
											</div>
										</div>
										<div class="row">
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=진행업무" id="cat3"  class="list-group-item category"><span class="icon-warning"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												진행업무 </a>
											</div>
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=회의" id="cat4"  class="list-group-item category"><span class="icon-primary"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												회의 </a>
											</div>
										</div>
										<div class="row">
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=보고" id="cat5"  class="list-group-item category"><span class="icon-warning"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												보고 </a>
											</div>
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=스크랩" id="cat6"  class="list-group-item category"><span class="icon-primary"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												스크랩 </a>
											</div>
										</div>
										<div class="row">
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=공지" id="cat7"  class="list-group-item category"><span class="icon-warning"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												공지 </a>
											</div>
											<div class="col-lg-6">
												<a href="{% url 'fillow:email_list' %}?category=감사인사" id="cat8"  class="list-group-item category"><span class="icon-primary"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												감사인사 </a>
											</div>
										</div>
										<div class="row">
											<div class="col-lg-12">
												<a href="{% url 'fillow:email_list' %}?category=기타" id="cat9"  class="list-group-item category"><span class="icon-warning"><i
													class="fa fa-circle" aria-hidden="true"></i></span>
												기타 </a>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xl-9 dlab-scroll height720">
							<div>
								<div role="toolbar" class="toolbar ms-1 ms-sm-0 ms-xl-1 d-flex align-items-center">

									<div class="btn-group mb-1">
										<button aria-expanded="false" data-bs-toggle="dropdown" class="btn btn-primary px-3 light dropdown-toggle mx-2" type="button">회사 <span
												class="caret"></span>
										</button>
										<div class="dropdown-menu"> <a href="{% url 'fillow:email_list' %}?internal=1" class="dropdown-item">내부</a> <a href="{% url 'fillow:email_list' %}?internal=0" class="dropdown-item">외부</a>
										</div>
									</div>
									<div class="btn-group mb-1">
										<button aria-expanded="false" data-bs-toggle="dropdown" class="btn btn-primary px-3 light dropdown-toggle mx-2" type="button">부서 <span
												class="caret"></span>
										</button>
										<div class="dropdown-menu"> <a href="{% url 'fillow:email_list' %}?internal_d=1" class="dropdown-item">내부</a> <a href="{% url 'fillow:email_list' %}?internal_d=0" class="dropdown-item">외부</a>
										</div>
									</div>
									<div class="btn-group mb-1">
										<button aria-expanded="false" data-bs-toggle="dropdown" class="btn btn-primary px-3 light dropdown-toggle mx-2" type="button">to/cc <span
												class="caret"></span>
										</button>
										<div class="dropdown-menu"> <a href="{% url 'fillow:email_list' %}?recipient=to" class="dropdown-item">to</a> <a href="{% url 'fillow:email_list' %}?recipient=cc" class="dropdown-item">cc</a>
										</div>
									</div>
									<div class="email-tools-box">
										<i class="fa-solid fa-list-ul"></i>
									</div>
									{% comment %} <form class=" d-none d-sm-block ms-auto">
										<div class="input-group  ms-auto w-100 d-sm-inline-flex d-none">
											<input type="text" class="form-control" placeholder="Search here">
											<span class="input-group-text"><button class="bg-transparent border-0"><i class="flaticon-381-search-2"></i></button></span>
										</div>
									</form> {% endcomment %}
									<form class="d-none d-sm-block ms-auto" action="{% url 'fillow:email_list' %}">
										<div class="input-group ms-auto w-100 d-sm-inline-flex d-none">
											<input type="text" class="form-control" placeholder="Search here" name="search_query">
											<span class="input-group-text"><button class="bg-transparent border-0"><i class="flaticon-381-search-2"></i></button></span>
										</div>
									</form>	
									<div class="btn-group mb-1">
										<a href="{% url 'fillow:email_list' %}" class="btn btn-primary light px-3">
											<i class="ti-reload"></i>
										</a>
									</div>
														
								</div>
        						<div class="email-list mt-3">
									{% for email in object_list %}
										<div class="message">
											<div>
												<div class="d-flex message-single">
													<div class="ms-2 rounded-cat d-flex align-items-center justify-content-center {% if email.read %}read{% endif %} {{ email.category }}">
														<span>{{ email.category }}</span>
													</div>
												</div>
												<a href="{% url 'fillow:email_detail' email.id %}" class="col-mail col-mail-2">
													<div class="subject"><span>{{ email.email_subject }}</span></div>
													<div class="date"><span>{{email.from_name}}&nbsp;&nbsp;&nbsp;{{ email.email_date|date:"Y M d D H:i" }}</span></div>
												</a>
												
											</div>
										</div>
									{% endfor %}

									{% if page_obj.paginator.num_pages > 1 %}
										<div class="row mt-4">
											<div class="col-12 ps-3">
												<nav>
													<ul class="pagination pagination-gutter pagination-primary pagination-sm no-bg justify-content-center justify-content-xl-start">
														{% if page_obj.has_previous %}
															<li class="page-item page-indicator"><a class="page-link" href="?page={{ page_obj.previous_page_number }}"><i class="la la-angle-left"></i></a></li>
														{% endif %}
														{% for num in page_obj.paginator.page_range %}
															<li class="page-item {% if page_obj.number == num %}active{% endif %}"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
														{% endfor %}
														{% if page_obj.has_next %}
															<li class="page-item page-indicator"><a class="page-link" href="?page={{ page_obj.next_page_number }}"><i class="la la-angle-right"></i></a></li>
														{% endif %}
													</ul>
												</nav>
											</div>
										</div>
									{% endif %}
									
								</div>
							</div>
						</div>
					</div>
					
					
				</div>
			</div>
		</div>
	</div>

</div>
</div>

{% endblock %}

{% block additional_js %}
<script>
	$(".fa.fa-star").click(function () {
		$(this).toggleClass("yellow");
	});

	document.addEventListener('DOMContentLoaded', function() {
		const urlParams = new URLSearchParams(window.location.search);
		const categoryParam = urlParams.get('category');
	
		// 버튼 요소 가져오기
		const inboxBtn = document.getElementById('inbox');
		const cat1Btn = document.getElementById('cat1');
		const cat2Btn = document.getElementById('cat2');
		const cat3Btn = document.getElementById('cat3');
		const cat4Btn = document.getElementById('cat4');
		const cat5Btn = document.getElementById('cat5');
		const cat6Btn = document.getElementById('cat6');
		const cat7Btn = document.getElementById('cat7');
		const cat8Btn = document.getElementById('cat8');
		const cat9Btn = document.getElementById('cat9');
	
		// URL의 category 쿼리 매개변수에 따라 버튼 활성화
		if (categoryParam === '결재승인') {
			cat1Btn.classList.add('active');
		} else if (categoryParam === '휴가') {
			cat2Btn.classList.add('active');
		} else if (categoryParam === '진행업무') {
			cat3Btn.classList.add('active');
		} else if (categoryParam === '회의') {
			cat4Btn.classList.add('active');
		} else if (categoryParam === '보고') {
			cat5Btn.classList.add('active');
		} else if (categoryParam === '스크랩') {
			cat6Btn.classList.add('active');
		} else if (categoryParam === '공지') {
			cat7Btn.classList.add('active');
		} else if (categoryParam === '감사인사') {
			cat8Btn.classList.add('active');
		} else if (categoryParam === '기타') {
			cat9Btn.classList.add('active');
		} else {
			inboxBtn.classList.add('active');
		}
	});
	const urlParams = new URLSearchParams(window.location.search);
	const myParam = urlParams.get('category');

	// 버튼 요소 가져오기
	const button = document.getElementById('selected');

	// URL의 쿼리 매개변수에 따라 버튼 클래스 변경
	if (myParam === 'active') {
		button.classList.add('active');
	}
</script>
{% endblock %}